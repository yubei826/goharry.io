webpackJsonp([0x922778226868],{638:function(e,s){e.exports={data:{markdownRemark:{html:'<p>supervisor 是基于 python 的任务管理工具，用来自动运行各种后台任务，当然你也能直接利用 nohup 命令使任务自动后台运行，但如果要重启任务，每次都自己手动 kill 掉任务进程，这样很繁琐，而且一旦程序错误导致进程退出的话，系统也无法自动重载任务。<!--more--></p>\n<p>virtualenv 是 python 的一个虚拟环境管理工具，用来部署运行不同的 python 版本，很多 linux 发行版本的 python 都是 2.x，例如要运行 3.x 版本的 python 程序，如果直接升级系统的 python 版本的话，由于 python 3.x 无法向前兼容 2.x 版本会造成系统依赖失效。</p>\n<h2>安装配置 virtualenv</h2>\n<div class="gatsby-highlight">\n      <pre class="language-shell"><code>pip install virtualenv</code></pre>\n      </div>\n<p>如果系统未安装 pip，可直接从源文件安装，记得用当前最新版本号代替 X.X</p>\n<div class="gatsby-highlight">\n      <pre class="language-shell"><code>curl -O https://pypi.python.org/packages/source/v/virtualenv/virtualenv-X.X.tar.gz\ntar xvfz virtualenv-X.X.tar.gz\ncd virtualenv-X.X\npython setup.py install</code></pre>\n      </div>\n<p>在项目目录下通过以下命令初始化和激活虚拟环境</p>\n<div class="gatsby-highlight">\n      <pre class="language-shell"><code>virtualenv ENV\ncd ENV\nsource bin/activate</code></pre>\n      </div>\n<h2>安装配置 supervisor</h2>\n<div class="gatsby-highlight">\n      <pre class="language-shell"><code>pip install supervisor</code></pre>\n      </div>\n<p>ubuntu server 上可直接 apt-get 安装</p>\n<div class="gatsby-highlight">\n      <pre class="language-shell"><code>sudo apt-get install supervisor</code></pre>\n      </div>\n<p>通过以下命令生成 supervisor 示例配置文件</p>\n<div class="gatsby-highlight">\n      <pre class="language-shell"><code>echo_supervisord_conf > /etc/supervisord.conf</code></pre>\n      </div>\n<p>修改 supervisord.conf 文件，通过添加 [program:name] 来新建一个任务，例如：</p>\n<div class="gatsby-highlight">\n      <pre class="language-shell"><code>[program:tornado]\ndirectory=/home/user/website/example.com\ncommand=python server.py\nautorestart=true\nstdout_logfile=/var/log/example.com/out.log\nstderr_log=/var/log/example.com/err.log</code></pre>\n      </div>\n<p>但我们利用了 virtualenv 来生成了不同的虚拟环境，这里的 command 直接是 python server.py 的肯定是会出错的，所以我们需要改成这样：</p>\n<div class="gatsby-highlight">\n      <pre class="language-shell"><code>[program:tornado]\ndirectory=/home/user/website/example.com\ncommand=/home/user/website/example.com/ENV/bin/python server.py\nautorestart=true\nstdout_logfile=/var/log/example.com/out.log\nstderr_log=/var/log/example.com/err.log</code></pre>\n      </div>\n<p>接下来运行以下命令运动 supervisor 服务：</p>\n<div class="gatsby-highlight">\n      <pre class="language-shell"><code>supervisord -c /etc/supervisord.conf\nsupervisorctl start tornado</code></pre>\n      </div>\n<p>重载 supervisor 里的任务可运行：</p>\n<div class="gatsby-highlight">\n      <pre class="language-shell"><code>supervisorctl restart tornado</code></pre>\n      </div>',excerpt:"supervisor 是基于 python 的任务管理工具，用来自动运行各种后台任务，当然你也能直接利用 nohup 命令使任务自动后台运行，但如果要重启任务，每次都自己手动 kill…",fields:{slug:"/ab5bd5df67",tags:[{name:"python",slug:"23eeeb4347"},{name:"virtualenv",slug:"d613f49da0"},{name:"supervisor",slug:"09348c20a0"}]},frontmatter:{date:"2014-08-24",path:"/setup-supervisor-based-on-virtualenv",title:"配置基于 virtualenv 的 supervisor"}},site:{siteMetadata:{disqusShortName:"devharry",siteUrl:"https://goharry.io"}}},pathContext:{slug:"/ab5bd5df67",prev:{excerpt:"webpack  是一款 js 模块管理工具， 能使用 commonjs 或者 es6 方式来管理 js 模块， 利用其 loader 插件还能做一些炫酷的事情， 比如利用 babel-loader 就能放心大胆的使用 es…",fields:{slug:"/4d4c26e465",tags:[{name:"javascript",slug:"de9b9ed78d"},{name:"webpack",slug:"424516ca53"},{name:"angular",slug:"d18b8624a0"}]},frontmatter:{path:"/angular-webpack",title:"使用 webpack 写 angular",date:"2015-11-12T00:00:00.000Z"}},next:{excerpt:"自己在路由器上跑了个不稳定版本的 OpenWrt，再加上 Netgear 4300 的性能也一般，在上面跑 shadowsocks，\n过段时间还是需要重启下的，每次重启都需要重新设定一次路由规则，所以要经常链接路由 SSH…",fields:{slug:"/ebb536cf72",tags:[{name:"openwrt",slug:"27d03b6f0f"},{name:"ssh",slug:"1787d76463"}]},frontmatter:{path:"/openwrt-authorized-key",title:"使用 ssh key 登陆 OpenWrt",date:"2014-08-19T00:00:00.000Z"}}}}}});
//# sourceMappingURL=path---ab-5-bd-5-df-67-102dbc7916899eaa5116.js.map